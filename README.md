# โปรแกรมรับจำนำ อัญชัน

โปรแกรมบันทึกขายฝากสำหรับร้านทอง ร้านโทรศัพท์มือถือ ธุรกิจรับขายฝากและจำนำ ที่มีการคิดดอกเบี้ยแบบรายเดือน

## คุณสมบัติหลัก

### ระบบจัดการลูกค้า
- บันทึกข้อมูลลูกค้าอัจฉริยะ (AG Customer)
- เก็บข้อมูลที่อยู่ เบอร์โทรศัพท์ เลขบัตรประชาชน
- ค้นหาลูกค้าได้หลายวิธี (ชื่อ, เลขบัตร, รหัสลูกค้า)
- ตรวจสอบความถูกต้องของข้อมูล
- **สแกนบัตรประชาชนอัตโนมัติ** - อ่านข้อมูลจากบัตรประชาชนไทยแบบ Smart Card และกรอกข้อมูลลงในฟอร์มอัตโนมัติ

### ระบบจัดการสินค้า
- บันทึกข้อมูลสินค้าขายฝาก
- รองรับรูปภาพสินค้าและสแกนเอกสาร
- เก็บรายละเอียดสินค้า (ยี่ห้อ, ขนาด, น้ำหนัก, ซีเรียล)
- จัดการคลังสินค้า

### ระบบสัญญา
- สร้างสัญญาขายฝากใหม่
- กำหนดอัตราดอกเบี้ยอิสระ
- คำนวณดอกเบี้ยและค่าปรับอัตโนมัติ
- ติดตามสถานะสัญญา

### ระบบการชำระ
- ชำระดอกเบี้ยรายเดือน
- ต่อดอกเบี้ย
- ไถ่ถอนสัญญา
- คำนวณค่าปรับและส่วนลด

### ระบบรายงาน
- รายงานประจำวัน
- รายงานประจำเดือน
- สรุปการขายฝาก
- ตารางดอกเบี้ย
- สัญญาที่ครบกำหนด

### ระบบค้นหา
- ค้นหาสัญญาตามเลขที่สัญญา
- ค้นหาตามชื่อลูกค้า
- ค้นหาตามเลขบัตรประชาชน
- กรองตามสถานะสัญญา

## การติดตั้ง

### ความต้องการระบบ
- Python 3.8 หรือใหม่กว่า
- PySide6
- SQLite3

### การติดตั้ง
1. Clone หรือดาวน์โหลดโปรเจค
2. ติดตั้ง dependencies:
```bash
pip install -r requirements.txt
```

3. รันโปรแกรม:
```bash
python main.py
```

## การใช้งาน

### เริ่มต้นใช้งาน
1. รันโปรแกรม
2. ระบบจะสร้างฐานข้อมูล SQLite อัตโนมัติ
3. เริ่มต้นด้วยการเพิ่มลูกค้าและสินค้า

### สร้างสัญญาใหม่
1. คลิก "สัญญาใหม่" หรือปุ่มใน toolbar
2. กรอกข้อมูลลูกค้า (คลิก "ค้นหา" เพื่อเลือกลูกค้า)
3. กรอกข้อมูลสินค้า
4. กำหนดยอดฝาก อัตราดอกเบี้ย และจำนวนวัน
5. คลิก "จัดเก็บ" เพื่อบันทึกสัญญา

### การชำระดอกเบี้ย
1. ค้นหาสัญญาที่ต้องการ
2. คลิก "ต่อดอก" ใน toolbar
3. กรอกข้อมูลการชำระ
4. บันทึกการชำระ

### การไถ่ถอน
1. ค้นหาสัญญาที่ต้องการไถ่ถอน
2. คลิก "ไถ่ถอน" ใน toolbar
3. ตรวจสอบยอดไถ่ถอน
4. บันทึกการไถ่ถอน

### การดูรายงาน
- **รายงานประจำวัน**: เมนู "รายงาน" > "รายงานประจำวัน"
- **รายงานประจำเดือน**: เมนู "รายงาน" > "รายงานประจำเดือน"
- **สรุปขายฝาก**: คลิกปุ่ม "สรุปขายฝาก" ใน toolbar

## โครงสร้างฐานข้อมูล

### ตารางหลัก
- **customers**: ข้อมูลลูกค้า
- **products**: ข้อมูลสินค้า
- **contracts**: ข้อมูลสัญญา
- **interest_payments**: การชำระดอกเบี้ย
- **redemptions**: การไถ่ถอน
- **settings**: การตั้งค่า

### ความสัมพันธ์
- ลูกค้า 1 คน สามารถมีสัญญาได้หลายสัญญา
- สัญญา 1 สัญญา มีสินค้า 1 ชิ้น
- สัญญา 1 สัญญา สามารถมีการชำระดอกเบี้ยได้หลายครั้ง
- สัญญา 1 สัญญา มีการไถ่ถอนได้ 1 ครั้ง

## การตั้งค่า

### การตั้งค่าพื้นฐาน
- อัตราดอกเบี้ยเริ่มต้น
- จำนวนวันเริ่มต้น
- ชื่อบริษัท
- ที่อยู่บริษัท
- เบอร์โทรศัพท์บริษัท
- รูปแบบเลขที่สัญญา

### การสำรองข้อมูล
- ระบบสำรองข้อมูลอัตโนมัติ
- สามารถกู้คืนข้อมูลได้
- ย้ายข้อมูลเก่าแยกเก็บ

## ฟีเจอร์พิเศษ

### ระบบความปลอดภัย
- ป้องกันการแก้ไขข้อมูลสัญญาหลังบันทึก
- ระบบสิทธิ์ผู้ใช้งาน
- การตรวจสอบความถูกต้องของข้อมูล

### การค้นหาขั้นสูง
- ค้นหาแบบ fuzzy search
- กรองตามช่วงวันที่
- เรียงลำดับตามเงื่อนไขต่างๆ

### การพิมพ์
- พิมพ์ใบเสร็จรับเงิน
- พิมพ์ตั๋วขายฝาก
- พิมพ์สัญญาเต็มรูปแบบ
- พิมพ์รายงานต่างๆ

### ระบบสแกนบัตรประชาชน
- อ่านข้อมูลจากบัตรประชาชนไทยแบบ Smart Card
- กรอกข้อมูลลงในฟอร์มอัตโนมัติ (ชื่อ, เลขบัตร, ที่อยู่)
- บันทึกรูปภาพจากบัตร
- รองรับ card reader ที่ใช้มาตรฐาน PC/SC
- ทำงานในเธรดแยกเพื่อไม่ให้ UI ค้าง

## การแก้ไขปัญหา

### ปัญหาที่พบบ่อย
1. **ไม่สามารถเชื่อมต่อฐานข้อมูล**: ตรวจสอบสิทธิ์การเขียนไฟล์
2. **โปรแกรมค้าง**: ตรวจสอบการเชื่อมต่อกับไฟล์ฐานข้อมูล
3. **ข้อมูลไม่แสดง**: ตรวจสอบการตั้งค่าและข้อมูลในฐานข้อมูล
4. **ไม่สามารถสแกนบัตรประชาชนได้**: ตรวจสอบ card reader และ PC/SC service

### การแก้ไข
1. ปิดโปรแกรม
2. ลบไฟล์ `pawnshop.db`
3. รันโปรแกรมใหม่ (จะสร้างฐานข้อมูลใหม่)

### การแก้ไขปัญหาสแกนบัตรประชาชน
1. **ไม่พบ card reader**: ตรวจสอบการเชื่อมต่อ USB และ driver
2. **ไม่พบบัตร**: ตรวจสอบการใส่บัตรและทำความสะอาดหน้าสัมผัส
3. **ไม่สามารถอ่านข้อมูลได้**: ตรวจสอบว่า card reader รองรับ PC/SC
4. **โมดูล smartcard ไม่พบ**: ติดตั้งด้วยคำสั่ง `pip install pyscard`

## การพัฒนา

### การเพิ่มฟีเจอร์
1. แก้ไขไฟล์ที่เกี่ยวข้อง
2. อัปเดตฐานข้อมูล (ถ้าจำเป็น)
3. ทดสอบฟีเจอร์ใหม่
4. อัปเดตเอกสาร

### การปรับแต่ง UI
- แก้ไขไฟล์ `main.py`
- ปรับแต่ง stylesheet
- เพิ่ม/ลบ widgets

### การพัฒนาฟีเจอร์สแกนบัตรประชาชน
- แก้ไขไฟล์ `dialogs.py` ในคลาส `ThaiIDCardScanner`
- เพิ่มฟิลด์ข้อมูลใหม่ในเมธอด `read_thai_id_card`
- ปรับแต่งการแสดงผลในเมธอด `on_card_data_ready`
- เพิ่มการตรวจสอบความถูกต้องของข้อมูล
- ทดสอบด้วยไฟล์ `test_id_card_scanner.py`

## ข้อมูลติดต่อ

สำหรับคำถามหรือข้อเสนอแนะ กรุณาติดต่อทีมพัฒนา

## ลิขสิทธิ์

โปรแกรมนี้พัฒนาเพื่อใช้งานภายในองค์กร กรุณาไม่แจกจ่ายหรือขายต่อโดยไม่ได้รับอนุญาต
# pawnshop
