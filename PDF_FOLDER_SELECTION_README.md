# ฟีเจอร์การเลือกโฟลเดอร์ในการจัดเก็บไฟล์ PDF

## ภาพรวม
ระบบได้เพิ่มฟีเจอร์ใหม่ที่ให้ผู้ใช้สามารถเลือกโฟลเดอร์ในการจัดเก็บไฟล์ PDF ได้เมื่อสร้าง PDF2 หรือสัญญาฝากต่อสำเร็จ

## ฟีเจอร์ที่เพิ่มเข้ามา

### 1. การเลือกโฟลเดอร์สำหรับใบขายฝาก (Pawn Contract)
- เมื่อคลิกปุ่ม "สร้างใบขายฝาก" ระบบจะแสดง dialog ให้เลือกโฟลเดอร์
- ผู้ใช้สามารถเลือกโฟลเดอร์ที่ต้องการจัดเก็บไฟล์ PDF
- ไฟล์จะถูกบันทึกในโฟลเดอร์ที่เลือกพร้อมชื่อไฟล์ที่เหมาะสม

### 2. การเลือกโฟลเดอร์สำหรับใบฝากต่อ (Renewal Contract)
- เมื่อคลิกปุ่ม "สร้างใบฝากต่อ" ระบบจะแสดง dialog ให้เลือกโฟลเดอร์
- ผู้ใช้สามารถเลือกโฟลเดอร์ที่ต้องการจัดเก็บไฟล์ PDF
- ไฟล์จะถูกบันทึกในโฟลเดอร์ที่เลือกพร้อมชื่อไฟล์ที่เหมาะสม

### 3. การเลือกโฟลเดอร์สำหรับสัญญาไถ่ถอน (Redemption Contract)
- เมื่อคลิกปุ่ม "สร้างสัญญาไถ่ถอน" ระบบจะแสดง dialog ให้เลือกโฟลเดอร์
- ผู้ใช้สามารถเลือกโฟลเดอร์ที่ต้องการจัดเก็บไฟล์ PDF
- ไฟล์จะถูกบันทึกในโฟลเดอร์ที่เลือกพร้อมชื่อไฟล์ที่เหมาะสม

## วิธีการใช้งาน

### วิธีที่ 1: ใช้ ask_folder=True
```python
from pdf2 import generate_renewal_contract_pdf

# ระบบจะแสดง dialog เลือกโฟลเดอร์อัตโนมัติ
result = generate_renewal_contract_pdf(
    original_contract_data=original_contract_data,
    customer_data=customer_data,
    product_data=product_data,
    renewal_data=renewal_data,
    shop_data=shop_data,
    ask_folder=True  # เปิดใช้งานการเลือกโฟลเดอร์
)
```

### วิธีที่ 2: ระบุโฟลเดอร์โดยตรง
```python
from pdf2 import generate_renewal_contract_pdf

# ระบุโฟลเดอร์โดยตรง
result = generate_renewal_contract_pdf(
    original_contract_data=original_contract_data,
    customer_data=customer_data,
    product_data=product_data,
    renewal_data=renewal_data,
    shop_data=shop_data,
    output_folder="/path/to/your/folder"  # ระบุโฟลเดอร์โดยตรง
)
```

### วิธีที่ 3: ใช้ฟังก์ชัน select_output_folder
```python
from pdf2 import select_output_folder

# เลือกโฟลเดอร์ด้วยตัวเอง
selected_folder = select_output_folder("เลือกโฟลเดอร์สำหรับจัดเก็บไฟล์")
if selected_folder:
    # ใช้โฟลเดอร์ที่เลือก
    pass
```

## ไฟล์ที่ได้รับการปรับปรุง

### 1. pdf2.py
- เพิ่มฟังก์ชัน `select_output_folder()` สำหรับเลือกโฟลเดอร์
- ปรับปรุงฟังก์ชัน `generate_renewal_contract_pdf()` ให้รองรับ `ask_folder` และ `output_folder`
- ปรับปรุงฟังก์ชัน `generate_renewal_receipt_pdf()` ให้รองรับ `ask_folder` และ `output_folder`

### 2. contract_pdf_generator.py
- เพิ่มฟังก์ชัน `select_save_folder()` สำหรับเลือกโฟลเดอร์
- ปรับปรุงฟังก์ชัน `generate_contract_pdf()` ให้รองรับ `ask_folder`
- ปรับปรุงฟังก์ชัน `generate_contract_pdf()` ให้รองรับการเลือกโฟลเดอร์

### 3. main.py
- ปรับปรุงฟังก์ชัน `generate_pawn_contract_pdf()` ให้ใช้ dialog เลือกโฟลเดอร์
- ปรับปรุงฟังก์ชัน `generate_renewal_contract_pdf()` ให้ใช้ dialog เลือกโฟลเดอร์

### 4. dialogs.py
- ปรับปรุงฟังก์ชัน `generate_renewal_pdf()` ใน RenewalDialog ให้ใช้ FolderSelectionDialog
- ปรับปรุงฟังก์ชัน `generate_redemption_contract_pdf()` ให้ใช้ FolderSelectionDialog

### 5. contract_pdf_dialog.py
- ปรับปรุงฟังก์ชัน `generate_pdf()` ให้ใช้ dialog เลือกโฟลเดอร์

## ข้อดีของฟีเจอร์ใหม่

1. **ความยืดหยุ่น**: ผู้ใช้สามารถเลือกโฟลเดอร์ที่ต้องการจัดเก็บไฟล์ได้
2. **ความเป็นระเบียบ**: สามารถจัดระเบียบไฟล์ PDF ตามประเภทหรือวันที่ได้
3. **ความสะดวก**: ไม่ต้องจำตำแหน่งไฟล์ที่บันทึกไว้
4. **ความปลอดภัย**: สามารถเลือกโฟลเดอร์ที่ปลอดภัยสำหรับจัดเก็บเอกสารสำคัญ

## การตั้งค่าเริ่มต้น

- ระบบจะเริ่มต้นจากโฟลเดอร์ที่ผู้ใช้ตั้งไว้ (home directory)
- สามารถเลือกโฟลเดอร์ใดก็ได้ในระบบ
- ระบบจะสร้างโฟลเดอร์ใหม่ถ้ายังไม่มีอยู่

## ข้อควรระวัง

1. ตรวจสอบสิทธิ์การเขียนในโฟลเดอร์ที่เลือก
2. ตรวจสอบพื้นที่ว่างในดิสก์
3. เก็บสำรองไฟล์สำคัญในโฟลเดอร์ที่ปลอดภัย

## การแก้ไขปัญหา

### ปัญหาที่พบบ่อย
1. **ไม่สามารถเลือกโฟลเดอร์ได้**: ตรวจสอบสิทธิ์การเข้าถึง
2. **ไฟล์ไม่ถูกบันทึก**: ตรวจสอบพื้นที่ว่างในดิสก์
3. **เกิดข้อผิดพลาด**: ตรวจสอบว่าฟอนต์ภาษาไทยอยู่ในโฟลเดอร์เดียวกัน

### การแก้ไข
1. รันโปรแกรมด้วยสิทธิ์ผู้ดูแลระบบ (ถ้าจำเป็น)
2. ตรวจสอบพื้นที่ว่างในดิสก์
3. ตรวจสอบไฟล์ฟอนต์ภาษาไทย
4. ตรวจสอบการติดตั้ง PySide6

## การพัฒนาต่อ

ฟีเจอร์นี้สามารถพัฒนาต่อได้ในอนาคต:
1. เพิ่มการจำโฟลเดอร์ที่ใช้บ่อย
2. เพิ่มการจัดหมวดหมู่ไฟล์อัตโนมัติ
3. เพิ่มการสำรองข้อมูลอัตโนมัติ
4. เพิ่มการแชร์ไฟล์ผ่านเครือข่าย
